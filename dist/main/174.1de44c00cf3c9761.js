"use strict";(self.webpackChunkcliniva=self.webpackChunkcliniva||[]).push([[174],{61174:(bt,q,s)=>{s.r(q),s.d(q,{OperationsModule:()=>At});var d=s(69808),Z=s(1402),n=s(93075),t=s(5e3),A=s(28464),O=s(57261),b=s(41299),_=s(77446),c=s(67322),C=s(77531),v=s(25245),g=s(86856),f=s(47423);function J(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Surgeon Name is required "),t.qZA())}function N(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Patient name is required "),t.qZA())}function F(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Operation type is required "),t.qZA())}function I(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Please select date "),t.qZA())}function L(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Patient email is required "),t.qZA())}function D(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid email "),t.qZA())}function Q(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Room number required "),t.qZA())}function E(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"form",10),t.NdJ("ngSubmit",function(){return t.CHM(e),t.oxw().onSubmit()}),t.TgZ(1,"div",11)(2,"div",12),t._UZ(3,"mat-checkbox",13),t._uU(4," \xa0 "),t.TgZ(5,"mat-label"),t._uU(6,"Successful Operation"),t.qZA()()(),t.TgZ(7,"div",11)(8,"div",12)(9,"mat-form-field",14)(10,"mat-label"),t._uU(11,"Surgeon Name"),t.qZA(),t._UZ(12,"input",15),t.TgZ(13,"mat-icon",16),t._uU(14,"info"),t.qZA(),t.YNc(15,J,2,0,"mat-error",17),t.qZA()()(),t.TgZ(16,"div",11)(17,"div",12)(18,"mat-form-field",14)(19,"mat-label"),t._uU(20,"Patient name"),t.qZA(),t._UZ(21,"input",18),t.TgZ(22,"mat-icon",16),t._uU(23,"info"),t.qZA(),t.YNc(24,N,2,0,"mat-error",17),t.qZA()()(),t.TgZ(25,"div",11)(26,"div",12)(27,"mat-form-field",14)(28,"mat-label"),t._uU(29,"Operation type"),t.qZA(),t._UZ(30,"input",19),t.TgZ(31,"mat-icon",16),t._uU(32,"store"),t.qZA(),t.YNc(33,F,2,0,"mat-error",17),t.qZA()()(),t.TgZ(34,"div",11)(35,"div",12)(36,"mat-form-field",14)(37,"mat-label"),t._uU(38,"Operation date"),t.qZA(),t._UZ(39,"input",20)(40,"mat-datepicker-toggle",21)(41,"mat-datepicker",null,22),t.YNc(43,I,2,0,"mat-error",17),t.qZA()()(),t.TgZ(44,"div",11)(45,"div",12)(46,"mat-form-field",14)(47,"mat-label"),t._uU(48,"Patient email"),t.qZA(),t._UZ(49,"input",23),t.TgZ(50,"mat-icon",16),t._uU(51,"email"),t.qZA(),t.YNc(52,L,2,0,"mat-error",17),t.YNc(53,D,2,0,"mat-error",17),t.qZA()()(),t.TgZ(54,"div",11)(55,"div",12)(56,"mat-form-field",14)(57,"mat-label"),t._uU(58,"Room number"),t.qZA(),t._UZ(59,"input",24),t.TgZ(60,"mat-icon",16),t._uU(61,"tag"),t.qZA(),t.YNc(62,Q,2,0,"mat-error",17),t.qZA()()(),t.TgZ(63,"div",11)(64,"div",12)(65,"div",25)(66,"button",26),t._uU(67,"Save"),t.qZA(),t.TgZ(68,"button",27),t._uU(69,"Cancel"),t.qZA()()()()()}if(2&o){const e=t.MAs(42),i=t.oxw();t.Q6J("formGroup",i.editOpForm),t.xp6(15),t.Q6J("ngIf",i.editOpForm.get("nomChi").hasError("required")),t.xp6(9),t.Q6J("ngIf",i.editOpForm.get("nomP").hasError("required")),t.xp6(9),t.Q6J("ngIf",i.editOpForm.get("typeOp").hasError("required")),t.xp6(6),t.Q6J("matDatepicker",e),t.xp6(1),t.Q6J("for",e),t.xp6(3),t.Q6J("ngIf",i.editOpForm.get("dateOp").hasError("required")),t.xp6(9),t.Q6J("ngIf",i.editOpForm.get("emailP").hasError("required")),t.xp6(1),t.Q6J("ngIf",i.editOpForm.get("emailP").hasError("email")),t.xp6(9),t.Q6J("ngIf",i.editOpForm.get("idChambre").hasError("required")),t.xp6(4),t.Q6J("disabled",!i.editOpForm.valid)}}const k=function(){return["Operation"]};let M=(()=>{class o{constructor(e,i,a,m){this.fb=e,this.route=i,this.opServ=a,this._snackBar=m,this.id=0}openSnackBar(e,i){this._snackBar.open(e,i)}onSubmit(){let e=this.editOpForm.value;e=Object.assign(Object.assign({},this.fetched),e),this.opServ.updateOperation(e).subscribe({next:i=>{this.openSnackBar("Edit success!","\u{1f601}")},error:i=>{console.log("error updating operation!"),this.openSnackBar("Edit failed!","\u{1f614}")}})}fetchData(){this.opServ.getOperationById(this.id).subscribe({next:e=>{console.log(e),this.fetched=e,this.editOpForm=this.fb.group({nomChi:[e.nomChi,[n.kI.required]],nomP:[e.nomP,[n.kI.required]],dateOp:[e.dateOp,[n.kI.required]],typeOp:[e.typeOp,[n.kI.required]],idChambre:[e.idChambre,[n.kI.required]],emailP:[e.emailP,[n.kI.required,n.kI.email]],success:[e.success]})},error:e=>{}})}ngOnInit(){this.sub=this.route.params.subscribe(e=>{this.id=+e.id}),this.fetchData()}ngOnDestroy(){this.sub.unsubscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(n.qu),t.Y36(Z.gz),t.Y36(A.f),t.Y36(O.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-edit-operation"]],decls:13,vars:5,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"row","clearfix"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"header"],[1,"body"],["class","register-form m-4",3,"formGroup","ngSubmit",4,"ngIf"],[1,"register-form","m-4",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-2"],["id","success","formControlName","success"],["appearance","outline",1,"example-full-width"],["matInput","","formControlName","nomChi","required",""],["matSuffix",""],[4,"ngIf"],["matInput","","formControlName","nomP","required",""],["matInput","","formControlName","typeOp","required",""],["matInput","","formControlName","dateOp",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","formControlName","emailP","type","email","required",""],["matInput","","formControlName","idChambre","type","number","required",""],[1,"example-button-row"],["mat-raised-button","","color","primary",3,"disabled"],["type","button","mat-button",""]],template:function(e,i){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-breadcrumb",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h2")(9,"strong"),t._uU(10,"Edit Operation"),t.qZA()()(),t.TgZ(11,"div",8),t.YNc(12,E,70,11,"form",9),t.qZA()()()()()()),2&e&&(t.xp6(3),t.Q6J("title","Edit Operation")("items",t.DdM(4,k))("active_item","Edit Operation"),t.xp6(9),t.Q6J("ngIf",i.editOpForm))},directives:[b.L,d.O5,n._Y,n.JL,n.sg,_.oG,n.JJ,n.u,c.hX,c.KE,C.Nt,n.Fj,n.Q7,v.Hw,c.R9,c.TO,g.hl,g.nW,g.Mq,n.wV,f.lW],styles:[""]}),o})();var P=s(38252),x=s(82848),U=s(74107),Y=s(90508),y=s(64449);function B(o,r){if(1&o&&(t.TgZ(0,"mat-option",32),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e.nomLogi)}}function w(o,r){if(1&o&&(t.TgZ(0,"mat-form-field",29)(1,"mat-label"),t._uU(2,"Logistics"),t.qZA(),t.TgZ(3,"mat-select",30),t.YNc(4,B,2,2,"mat-option",31),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("formControl",e.selectedLogistics),t.xp6(1),t.Q6J("ngForOf",e.defaultLogistics)}}function R(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Patient name is required "),t.qZA())}function G(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Operation type is required "),t.qZA())}function j(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Please select date "),t.qZA())}function H(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Patient email is required "),t.qZA())}function V(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid email "),t.qZA())}function z(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Room number required "),t.qZA())}function W(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"form",11),t.NdJ("ngSubmit",function(){return t.CHM(e),t.oxw().onSubmit()}),t.TgZ(1,"div",12)(2,"div",13),t._UZ(3,"mat-checkbox",14),t._uU(4," \xa0 "),t.TgZ(5,"mat-label"),t._uU(6,"Successful Operation"),t.qZA()()(),t.TgZ(7,"div",12)(8,"div",13),t.YNc(9,w,5,2,"mat-form-field",15),t.qZA()(),t.TgZ(10,"div",12)(11,"div",13)(12,"mat-form-field",16)(13,"mat-label"),t._uU(14,"Patient name"),t.qZA(),t._UZ(15,"input",17),t.TgZ(16,"mat-icon",18),t._uU(17,"info"),t.qZA(),t.YNc(18,R,2,0,"mat-error",19),t.qZA()()(),t.TgZ(19,"div",12)(20,"div",13)(21,"mat-form-field",16)(22,"mat-label"),t._uU(23,"Operation type"),t.qZA(),t._UZ(24,"input",20),t.TgZ(25,"mat-icon",18),t._uU(26,"store"),t.qZA(),t.YNc(27,G,2,0,"mat-error",19),t.qZA()()(),t.TgZ(28,"div",12)(29,"div",13)(30,"mat-form-field",16)(31,"mat-label"),t._uU(32,"Operation date"),t.qZA(),t.TgZ(33,"input",21),t.NdJ("dateChange",function(a){return t.CHM(e),t.oxw().filterDocsPerDateGiven(a)}),t.qZA(),t._UZ(34,"mat-datepicker-toggle",22)(35,"mat-datepicker",null,23),t.YNc(37,j,2,0,"mat-error",19),t.qZA()()(),t.TgZ(38,"div",12)(39,"div",13)(40,"mat-form-field",16)(41,"mat-label"),t._uU(42,"Patient email"),t.qZA(),t._UZ(43,"input",24),t.TgZ(44,"mat-icon",18),t._uU(45,"email"),t.qZA(),t.YNc(46,H,2,0,"mat-error",19),t.YNc(47,V,2,0,"mat-error",19),t.qZA()()(),t.TgZ(48,"div",12)(49,"div",13)(50,"mat-form-field",16)(51,"mat-label"),t._uU(52,"Room number"),t.qZA(),t._UZ(53,"input",25),t.TgZ(54,"mat-icon",18),t._uU(55,"tag"),t.qZA(),t.YNc(56,z,2,0,"mat-error",19),t.qZA()()(),t.TgZ(57,"div",12)(58,"div",13)(59,"div",26)(60,"button",27),t._uU(61,"Save"),t.qZA(),t.TgZ(62,"button",28),t._uU(63,"Cancel"),t.qZA()()()()()}if(2&o){const e=t.MAs(36),i=t.oxw();t.Q6J("formGroup",i.addOpForm),t.xp6(9),t.Q6J("ngIf",i.defaultLogistics),t.xp6(9),t.Q6J("ngIf",i.addOpForm.get("nomP").hasError("required")),t.xp6(9),t.Q6J("ngIf",i.addOpForm.get("typeOp").hasError("required")),t.xp6(6),t.Q6J("matDatepicker",e),t.xp6(1),t.Q6J("for",e),t.xp6(3),t.Q6J("ngIf",i.addOpForm.get("dateOp").hasError("required")),t.xp6(9),t.Q6J("ngIf",i.addOpForm.get("emailP").hasError("required")),t.xp6(1),t.Q6J("ngIf",i.addOpForm.get("emailP").hasError("email")),t.xp6(9),t.Q6J("ngIf",i.addOpForm.get("idChambre").hasError("required")),t.xp6(4),t.Q6J("disabled",!i.addOpForm.valid)}}function X(o,r){if(1&o&&(t.TgZ(0,"mat-list-option",32)(1,"p"),t._uU(2),t.qZA()()),2&o){const e=r.$implicit;t.Q6J("value",e),t.xp6(2),t.hij(" Dr :",e," ")}}function $(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"form",33)(1,"mat-selection-list",34,35),t.NdJ("change",function(a){return t.CHM(e),t.oxw().filterDocsPerDateGiven(a)}),t.YNc(3,X,3,2,"mat-list-option",31),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("formGroup",e.addOpForm),t.xp6(1),t.Q6J("multiple",!1),t.xp6(2),t.Q6J("ngForOf",e.docNames)}}const K=function(){return["Operations"]};let tt=(()=>{class o{constructor(e,i,a,m){this.fb=e,this.operationService=i,this.logsService=a,this._snackBar=m,this.docNames=[],this.operations=[],this.selectedLogistics=new n.NI(""),this.defaultLogistics=[],this.selectedDocNumberOfOperations=0,this.overlappingDocs=()=>{this.selectedDocNumberOfOperations=0;const l=new Date(`${this.addOpForm.value.dateOp}`).toISOString().split("T")[0],p=this.addOpForm.value.nomChi[0];return this.operations.filter(h=>h.nomChi===p).forEach(h=>{console.log(h,l,h.dateOp.toString()===l),h.dateOp.toString()===l&&this.selectedDocNumberOfOperations++}),this.selectedDocNumberOfOperations>0}}ngOnInit(){this.addOpForm=this.fb.group({nomP:["",[n.kI.required]],dateOp:["",[n.kI.required]],typeOp:["",[n.kI.required]],nomChi:[""],idChambre:[0],emailP:["",[n.kI.required,n.kI.email]],success:[!1]}),this.fetchLogistics(),this.fetchDoctors(),this.fetchOps()}openSnackBar(e,i){this._snackBar.open(e,i)}onSubmit(){if(this.selectedLogistics.value.filter(e=>0==e.nombreLogi).length>0)this.openSnackBar("Logistics are CLAWZED","\u{1f921}");else{const e={nomChi:this.addOpForm.value.nomChi[0]},i=Object.assign(Object.assign({},this.addOpForm.value),e),a=[];for(let m=0;m<this.selectedLogistics.value.length;m++)a.push(this.selectedLogistics.value[m]);this.operationService.addOperation(i,a).subscribe({next:m=>{this.openSnackBar("Operation saved!","\u2705")},error:m=>{this.openSnackBar("Operation not saved!","\u274c")}})}}fetchLogistics(){this.logsService.getAllLogistiques().subscribe({next:e=>this.defaultLogistics=e})}fetchDoctors(){this.operationService.getAllUsers().subscribe({next:e=>{this.docNames=e.filter(i=>i.role[0].name===P.u.Doctor).map(i=>i.nom),console.log(this.docNames)}})}fetchOps(){this.operationService.getAllOperations().subscribe({next:e=>{this.operations=e,this.operations.forEach(i=>{})}})}filterDocsPerDateGiven(){this.addOpForm.value.nomChi[0]&&this.overlappingDocs()&&this.openSnackBar("Invalid date or doctor!","\u274c")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(n.qu),t.Y36(A.f),t.Y36(x.G),t.Y36(O.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-add-operation"]],decls:23,vars:7,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"row","clearfix"],[1,"col-xl-6","col-lg-6","col-md-6","col-sm-6"],[1,"card"],[1,"header"],[1,"body"],["class","register-form m-4",3,"formGroup","ngSubmit",4,"ngIf"],["class","register-form m-4",3,"formGroup",4,"ngIf"],[1,"register-form","m-4",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-2"],["formControlName","success"],["appearance","outline",4,"ngIf"],["appearance","outline",1,"example-full-width"],["matInput","","formControlName","nomP","required",""],["matSuffix",""],[4,"ngIf"],["matInput","","formControlName","typeOp","required",""],["matInput","","formControlName","dateOp",3,"matDatepicker","dateChange"],["matSuffix","",3,"for"],["picker",""],["matInput","","formControlName","emailP","type","email","required",""],["matInput","","formControlName","idChambre","type","number","required",""],[1,"example-button-row"],["mat-raised-button","","color","primary",3,"disabled"],["type","button","mat-button",""],["appearance","outline"],["multiple","",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"register-form","m-4",3,"formGroup"],["formControlName","nomChi",3,"multiple","change"],["docNamesSec",""]],template:function(e,i){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-breadcrumb",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h2")(9,"strong"),t._uU(10,"Add Operation"),t.qZA()()(),t.TgZ(11,"div",8),t.YNc(12,W,64,11,"form",9),t.qZA()()(),t.TgZ(13,"div",5)(14,"div",6)(15,"div",7)(16,"h2")(17,"strong"),t._uU(18,"Doctors list"),t.qZA()()(),t.TgZ(19,"div",8)(20,"div"),t._uU(21),t.qZA(),t.YNc(22,$,4,3,"form",10),t.qZA()()()()()()),2&e&&(t.xp6(3),t.Q6J("title","Add Operation")("items",t.DdM(6,K))("active_item","Add Operation"),t.xp6(9),t.Q6J("ngIf",i.addOpForm),t.xp6(9),t.hij(" Number of operations for selected doc: ",i.selectedDocNumberOfOperations," "),t.xp6(1),t.Q6J("ngIf",i.addOpForm))},directives:[b.L,d.O5,n._Y,n.JL,n.sg,_.oG,n.JJ,n.u,c.hX,c.KE,U.gD,n.oH,d.sg,Y.ey,C.Nt,n.Fj,n.Q7,v.Hw,c.R9,c.TO,g.hl,g.nW,g.Mq,n.wV,f.lW,y.Ub,y.vS],styles:[""]}),o})();var T=s(92181),et=s(61676),S=s(86087);function ot(o,r){if(1&o&&(t.TgZ(0,"button",33)(1,"mat-icon"),t._uU(2,"description"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&o){const e=r.$implicit;t.xp6(4),t.Oqu(e.nomLogi)}}const it=function(o){return["/admin/operations/edit-operation",o]};function rt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"mat-checkbox",27),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"date"),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.qZA(),t.TgZ(18,"td")(19,"button",28)(20,"mat-icon"),t._uU(21,"more_hori"),t.qZA()(),t.TgZ(22,"mat-menu",null,16),t.YNc(24,ot,5,1,"button",29),t.qZA()(),t.TgZ(25,"td")(26,"a",30),t._UZ(27,"app-feather-icons",31),t.qZA(),t.TgZ(28,"button",32),t.NdJ("click",function(){const m=t.CHM(e).$implicit;return t.oxw().deleteOperation(m.idOp)}),t._UZ(29,"app-feather-icons",31),t.qZA(),t.TgZ(30,"button",32),t.NdJ("click",function(){const m=t.CHM(e).$implicit;return t.oxw().toggleSuccess(m)}),t._UZ(31,"app-feather-icons",31),t.qZA()()()}if(2&o){const e=r.$implicit,i=t.MAs(23);t.xp6(2),t.Oqu(e.idOp),t.xp6(2),t.s9C("checked",e.success),t.xp6(2),t.Oqu(e.nomChi),t.xp6(2),t.Oqu(e.nomP),t.xp6(2),t.Oqu(t.xi3(11,20,e.dateOp,"yyyy-MM-dd")),t.xp6(3),t.Oqu(e.typeOp),t.xp6(2),t.Oqu(e.idChambre),t.xp6(2),t.Oqu(e.emailP),t.xp6(2),t.Q6J("matMenuTriggerFor",i),t.xp6(5),t.Q6J("ngForOf",e.logistiques),t.xp6(2),t.Q6J("routerLink",t.VKq(23,it,e.idOp)),t.xp6(1),t.Tol("tbl-fav-edit"),t.Q6J("icon","edit"),t.xp6(2),t.Tol("tbl-fav-delete"),t.Q6J("icon","trash-2"),t.xp6(2),t.Tol("tbl-fav-edit"),t.Q6J("icon","check-circle")}}function nt(o,r){if(1&o&&(t.TgZ(0,"li",34),t._uU(1),t.TgZ(2,"div",35)(3,"div",36),t._uU(4),t.qZA()()()),2&o){const e=r.$implicit;t.xp6(1),t.hij(" ",e.key," "),t.xp6(2),t.Gre("progress-bar l-bg-orange width-per-",100*e.value,""),t.Q6J("aria-valuenow",e.value),t.xp6(1),t.hij(" ",100*e.value,"% ")}}const at=function(){return["Operations"]},st=function(){return[10,20,30]},ct=[{path:"",component:(()=>{class o{constructor(e,i,a){this.operationService=e,this.logisService=i,this._snackBar=a,this.operations=[],this.filteredOperations=[],this.searchTerm="",this.successRates=new Map,this.sortingCriteria="",this.lowValue=0,this.highValue=10}ngOnInit(){this.getAllOperations(),this.getSuccessRatesByType()}getPaginatorData(e){return this.lowValue=e.pageIndex*e.pageSize,this.highValue=this.lowValue+e.pageSize,e}getAllOperations(){this.operationService.getAllOperations().subscribe({next:e=>{this.operations=e,this.setLogistics(),this.sortOperations(),this.filterOperations()},error:e=>{console.log(e)}})}setLogistics(){this.operations.forEach(e=>{let i=[];console.table(e),e.logistiques.forEach(a=>this.logisService.getLogistiqueById(a).subscribe({next:m=>i.push(m)})),e.logistiques=i})}sortByType(){this.sortingCriteria="typeOp",this.sortOperations()}sortByDate(){this.sortingCriteria="dateOp",this.sortOperations()}sortByTypeAndDate(){this.sortingCriteria="typeAndDate",this.sortOperations()}sortOperations(){if(this.sortingCriteria){const e=this.sortingCriteria.split("-"),i=this.sortingCriteria.startsWith("-");this.operations.sort((a,m)=>{for(let l=0;l<e.length;l++){const p=e[l];if("dateOp"===p){const u=a[p]>m[p]?1:a[p]<m[p]?-1:0;if(0!==u)return i?-u:u}else if("typeOp"===p){const u=a[p].toLowerCase()>m[p].toLowerCase()?1:a[p].toLowerCase()<m[p].toLowerCase()?-1:0;if(0!==u)return i?-u:u}}return i?m.idOp-a.idOp:a.idOp-m.idOp})}}openSnackBar(e,i){this._snackBar.open(e,i)}toggleSuccess(e){e.success=!e.success,this.operationService.updateOperation(e).subscribe({next:i=>{const a=this.filteredOperations.indexOf(e);-1!==a&&(this.filteredOperations[a].success=i.success,this.successRates.set(e.typeOp,this.successRates.get(e.typeOp)+(e.success?1:-1)))},error:i=>{this.openSnackBar("Add failed!","\u{1f614}")}})}filterOperations(){this.filteredOperations=this.searchTerm?this.operations.filter(e=>e.typeOp&&e.typeOp.toLowerCase().includes(this.searchTerm.toLowerCase())||e.nomChi&&e.nomChi.toLowerCase().includes(this.searchTerm.toLowerCase())||e.nomP&&e.nomP.toLowerCase().includes(this.searchTerm.toLowerCase())):this.operations}getSuccessRatesByType(){this.operationService.getSuccessRatesByType().subscribe(e=>{this.successRates=e},e=>{console.error(e)})}deleteOperation(e){console.log(e),this.operationService.deleteOperation(e).subscribe({next:()=>{this.operations=this.operations.filter(i=>i.idOp!==e),this.sortOperations(),this.filterOperations()},error:i=>{console.log(i)}})}setSortingCriteria(e){this.sortingCriteria=this.sortingCriteria===e?"-"+e:e,this.sortOperations(),this.filterOperations()}clearSortingCriteria(){this.sortingCriteria="",this.sortOperations(),this.filterOperations()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.f),t.Y36(x.G),t.Y36(O.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-list-operations"]],decls:68,vars:17,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"container","mt-10"],[1,"row"],[1,"col"],[1,"col-md-10"],[1,"materialTableHeader"],[1,"header-buttons-left","ms-0"],[1,"dropdown","m-l-20"],["for","search-input"],[1,"material-icons","search-icon"],["placeholder","Search","type","text","name","searchTerm","aria-label","Search box",1,"browser-default","search-field",3,"ngModel","ngModelChange","input"],["filter",""],["mat-button","",1,"header-dropdown",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],["pageSize","10","showFirstLastButtons","false",3,"length","pageSizeOptions","page"],[1,"col-md-2"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],["disabled","",3,"checked"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["mat-menu-item","",4,"ngFor","ngForOf"],["mat-icon-button","",1,"tbl-action-btn",3,"routerLink"],[3,"icon"],["mat-icon-button","",1,"tbl-action-btn",3,"click"],["mat-menu-item",""],[1,"list-group-item"],[1,"progress","shadow-style"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",3,"aria-valuenow"]],template:function(e,i){if(1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-breadcrumb",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"h2"),t._uU(8,"Operations List"),t.qZA()()(),t.TgZ(9,"div",5)(10,"div",7)(11,"div",8)(12,"div",5)(13,"div",7)(14,"ul",9)(15,"li",10)(16,"label",11)(17,"i",12),t._uU(18,"search"),t.qZA()(),t.TgZ(19,"input",13,14),t.NdJ("ngModelChange",function(m){return i.searchTerm=m})("input",function(){return i.filterOperations()}),t.qZA()(),t.TgZ(21,"li")(22,"button",15)(23,"mat-icon"),t._uU(24,"filter_list"),t.qZA()(),t.TgZ(25,"mat-menu",null,16)(27,"button",17),t.NdJ("click",function(){return i.sortByType()}),t._uU(28,"Type"),t.qZA(),t.TgZ(29,"button",17),t.NdJ("click",function(){return i.sortByDate()}),t._uU(30,"Date"),t.qZA(),t.TgZ(31,"button",17),t.NdJ("click",function(){return i.sortByTypeAndDate()}),t._uU(32,"Type and Date"),t.qZA()()()()()()(),t.TgZ(33,"table",18)(34,"thead")(35,"tr")(36,"th"),t._uU(37,"ID"),t.qZA(),t.TgZ(38,"th"),t._uU(39,"Success"),t.qZA(),t.TgZ(40,"th"),t._uU(41,"nom chirurgien"),t.qZA(),t.TgZ(42,"th"),t._uU(43,"nom patient"),t.qZA(),t.TgZ(44,"th"),t._uU(45,"Date"),t.qZA(),t.TgZ(46,"th"),t._uU(47,"Type"),t.qZA(),t.TgZ(48,"th"),t._uU(49,"Room ID"),t.qZA(),t.TgZ(50,"th"),t._uU(51,"EMAIL"),t.qZA(),t.TgZ(52,"th"),t._uU(53,"Logistics"),t.qZA(),t.TgZ(54,"th"),t._uU(55,"Actions"),t.qZA()()(),t.TgZ(56,"tbody"),t.YNc(57,rt,32,25,"tr",19),t.ALo(58,"slice"),t.qZA()(),t.TgZ(59,"mat-paginator",20),t.NdJ("page",function(m){return i.getPaginatorData(m)}),t.qZA()(),t.TgZ(60,"div",21)(61,"div",22)(62,"div",23)(63,"h5",24),t._uU(64,"Success Rates by Type"),t.qZA(),t.TgZ(65,"ul",25),t.YNc(66,nt,5,6,"li",26),t.ALo(67,"keyvalue"),t.qZA()()()()()()()()),2&e){const a=t.MAs(26);t.xp6(3),t.Q6J("title","Add Operation")("items",t.DdM(15,at))("active_item","Add Operation"),t.xp6(16),t.Q6J("ngModel",i.searchTerm),t.xp6(3),t.Q6J("matMenuTriggerFor",a),t.xp6(35),t.Q6J("ngForOf",t.Dn7(58,9,i.filteredOperations,i.lowValue,i.highValue)),t.xp6(2),t.Q6J("length",i.filteredOperations.length)("pageSizeOptions",t.DdM(16,st)),t.xp6(7),t.Q6J("ngForOf",t.lcZ(67,13,i.successRates))}},directives:[b.L,n.Fj,n.JJ,n.On,f.lW,T.p6,v.Hw,T.VK,T.OP,d.sg,_.oG,f.zs,Z.yS,et.A,S.NW],pipes:[d.OU,d.uU,d.Nd],styles:[""]}),o})()},{path:"edit-operation/:id",component:M},{path:"add-operation",component:tt},{path:"**",component:s(1991).J}];let lt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[Z.Bz.forChild(ct)],Z.Bz]}),o})();var dt=s(48966),ut=s(20773),gt=s(79814),ft=s(84847),ht=s(32075),Zt=s(53251),Ot=s(34594),_t=s(21385),vt=s(15626),Tt=s(5458);let At=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[lt,d.ez,n.u5,n.UX,ht.p0,S.TU,c.lN,C.c,O.ZX,f.ot,T.Tx,v.Ps,dt.Is,ft.JX,Ot.g0,gt.Fk,U.LD,_.p9,g.FA,_t.Ad,Zt.Nh,ut.Cq,vt.K,Tt.m]]}),o})()}}]);